

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Description &mdash; tSPICE 0.0.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=e3a6060d"></script>
      <script src="_static/doctools.js?v=fd6eb6e6"></script>
      <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorials and Examples" href="examples.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            tSPICE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">EXAMPLES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Tutorials and Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tides.html">Tides Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="planet.html">Planet Module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">tSPICE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Description</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p></p>
<div align="center">
  <!-- <img src="https://raw.githubusercontent.com/DeivyMercado/TSPICE/main/docs/tspice-logo-white.webp" alt="tSPICE Logo" width="600"/> -->
  <img src="https://raw.githubusercontent.com/seap-udea/tspice/main/docs/tspice-logo-white.webp" alt="tSPICE Logo" width="600"/>
</div>
<p></p><a class="reference external image-reference" href="https://pypi.org/project/tspice/"><img alt="pypi" src="https://img.shields.io/badge/pypi-v0.0.2-blue" />
</a>
<a class="reference external image-reference" href="https://github.com/DeivyMercado/TSPICE/blob/master/LICENSE"><img alt="License" src="https://img.shields.io/badge/License-AGPL%20v3-blue.svg" />
</a>
<a class="reference external image-reference" href="https://pypi.org/project/tspice/"><img alt="python" src="https://img.shields.io/badge/python-3-grey" />
</a>
<a class="reference external image-reference" href="https://github.com/AndrewAnnex/SpiceyPy"><img alt="Powered by SpiceyPy" src="https://img.shields.io/badge/Powered%20by-SpiceyPy-blue" />
</a>
<a class="reference external image-reference" href="https://arxiv.org/abs/0000.00000"><img alt="arXiv" src="https://img.shields.io/badge/arXiv-0000.00000-orange.svg?style=flat" />
</a>
<p><strong>tSPICE</strong> is a Python package developed for the calculation of the tidal potential and the planetary response, using SPICE kernels.</p>
<section id="description">
<h1>Description<a class="headerlink" href="#description" title="Link to this heading"></a></h1>
<p>tSPICE develops a coherent pathway from the fundamentals of tidal potential theory and elasticity to practical computations of tidal signals and elastic responses. The package uses SPICE’s kernels and modular routines to compute tidal signals and integrate planetary interior models.</p>
<p>This work was developed as part of the Bachelor’s thesis <strong>“Planetary Tides and Elastic Response: From Theory to Calculations”</strong> by Deivy J. Mercado R. under the supervision of Prof. Jorge I. Zuluaga and Prof. Gloria Moncayo (2026).</p>
<p>Key features:</p>
<ul class="simple">
<li><p><strong>Tidal Potential</strong>: Implements Tide-Generating Potentials (TGPs) in spherical-harmonic form.</p></li>
<li><p><strong>Elastic Response</strong>: Solves governing elastodynamic equations for self-gravitating, elastic, transversely isotropic, spherical bodies.</p></li>
<li><p><strong>Integration</strong>: Solves coupled first-order ODEs for displacement, strain, stress, and perturbing potential fields.</p></li>
<li><p><strong>Validation</strong>: Reproduces tidal signals on Earth consistent with ETERNA-x and computes Love numbers in agreement with literature (e.g., using a modified PREM Earth model).</p></li>
</ul>
</section>
<section id="theoretical-background">
<h1>Theoretical Background<a class="headerlink" href="#theoretical-background" title="Link to this heading"></a></h1>
<p>Tides are not merely the rise and fall of oceans; they are a fundamental consequence of the differential gravitational forces exerted by external bodies on an extended planetary body. <strong>tSPICE</strong> provides a computational framework to explore this phenomenon from first principles.</p>
<section id="the-tide-generating-potential-tgp">
<h2>The Tide-Generating Potential (TGP)<a class="headerlink" href="#the-tide-generating-potential-tgp" title="Link to this heading"></a></h2>
<p>The gravitational field of an external body (like the Moon or Sun) varies across a planet’s volume. By subtracting the orbital acceleration (the force felt by the planet as a whole), we isolate the <strong>Tide-Generating Potential (TGP)</strong>. This potential is mathematically expanded using <strong>Spherical Harmonics</strong>, allowing us to decompose the complex tidal signal into precise spatial patterns and temporal frequencies (semidiurnal, diurnal, and long-period bands).</p>
</section>
<section id="planetary-elastic-response">
<h2>Planetary Elastic Response<a class="headerlink" href="#planetary-elastic-response" title="Link to this heading"></a></h2>
<p>Planets are not rigid; they deform under the influence of the TGP. <strong>tSPICE</strong> models the planet as a <strong>self-gravitating, elastic, transversely isotropic sphere</strong>. This means we account for:</p>
<ul class="simple">
<li><p><strong>Self-gravity</strong>: How the planet’s own gravity resists deformation.</p></li>
<li><p><strong>Elasticity</strong>: The material’s tendency to return to its original shape, governed by stress-strain relations.</p></li>
<li><p><strong>Transverse Isotropy</strong>: A realistic approximation for layered planets where material properties (density, elastic moduli) change radially.</p></li>
</ul>
</section>
<section id="love-numbers">
<h2>Love Numbers<a class="headerlink" href="#love-numbers" title="Link to this heading"></a></h2>
<p>The deformation is quantified using dimensionless coefficients known as <strong>Love Numbers</strong> ($h_n, l_n, k_n$). These numbers act as transfer functions, connecting the external potential to:</p>
<ul class="simple">
<li><p><strong>Radial and Tangential Displacement</strong> ($h_n, l_n$): How much the surface moves up/down and sideways.</p></li>
<li><p><strong>Potential Perturbation</strong> ($k_n$): How the planet’s redistribution of mass changes its own gravitational field.</p></li>
</ul>
</section>
<section id="numerical-integration">
<h2>Numerical Integration<a class="headerlink" href="#numerical-integration" title="Link to this heading"></a></h2>
<p>To compute these values, <strong>tSPICE</strong> solves a system of coupled first-order Ordinary Differential Equations (ODEs) derived from the <strong>Navier-Cauchy equation of motion</strong> and <strong>Poisson’s equation</strong> for gravity. The package integrates these equations from the planet’s center to the surface, applying rigorous boundary conditions to ensure physical consistency.</p>
</section>
</section>
<section id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h1>
<p>You can install it easily with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>tspice
</pre></div>
</div>
</section>
<section id="quick-start">
<h1>Quick Start<a class="headerlink" href="#quick-start" title="Link to this heading"></a></h1>
<p>After installation, you can start using the package:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tspice</span>
</pre></div>
</div>
<p>Before your first calculation, initialize the package to load SPICE kernels:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tspice</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
</pre></div>
</div>
<p>This function ensures that tThe second time you use tSPICE, texttt{initialize} won’t download the kernels again.f not present) and loaded.</p>
</section>
<section id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h1>
<section id="calculating-the-tide-generating-potential-tgp">
<h2>Calculating the Tide-Generating Potential (TGP)<a class="headerlink" href="#calculating-the-tide-generating-potential-tgp" title="Link to this heading"></a></h2>
<p>Here is a quick example of how to calculate the tidal potential generated by the Moon on Earth.</p>
<p>First, initialize the package and define the location on the planetary body:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tspice</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Initialize tSPICE (loads kernels)</span>
<span class="n">tspice</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Define the location (lat, lon, depth)</span>
<span class="n">loc</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="mf">4.49</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="o">-</span><span class="mf">73.14</span><span class="p">,</span> <span class="n">depth</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Define the time range and the body object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the time range</span>
<span class="n">date</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;2025-05-25 13:08:05&#39;</span><span class="p">,</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="s1">&#39;2025-06-22 13:08:05&#39;</span><span class="p">,</span>
            <span class="n">step</span> <span class="o">=</span> <span class="s1">&#39;1h&#39;</span><span class="p">,</span>
            <span class="n">time_frame</span> <span class="o">=</span> <span class="s1">&#39;UTC&#39;</span><span class="p">)</span>

<span class="c1"># Create a planetary body object (Earth)</span>
<span class="n">earth</span> <span class="o">=</span> <span class="n">tspice</span><span class="o">.</span><span class="n">Body</span><span class="p">(</span><span class="s1">&#39;Earth&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate the TGP for a single body (in this case, the Moon):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate TGP for a single body (Moon)</span>
<span class="n">tgp_one</span><span class="p">,</span> <span class="n">et_utc</span> <span class="o">=</span> <span class="n">earth</span><span class="o">.</span><span class="n">tgp_one_body</span><span class="p">(</span><span class="s1">&#39;Moon&#39;</span><span class="p">,</span> <span class="n">loc_sta</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">dates</span><span class="o">=</span><span class="n">date</span><span class="p">,</span> <span class="n">nmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">time_array</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, plot the resulting signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the signal</span>
<span class="n">earth</span><span class="o">.</span><span class="n">plot_one_signal</span><span class="p">(</span><span class="n">et_utc</span><span class="p">,</span> <span class="n">tgp_one</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">mean_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">savepath</span><span class="o">=</span><span class="s1">&#39;./tgp-earth-moon.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference external image-reference" href="https://raw.githubusercontent.com/seap-udea/tspice/main/examples/gallery/tgp-earth-moon.png"><img alt="TGP Earth Moon" src="https://raw.githubusercontent.com/seap-udea/tspice/main/examples/gallery/tgp-earth-moon.png" />
</a>
</section>
<section id="multiple-bodies">
<h2>Multiple Bodies<a class="headerlink" href="#multiple-bodies" title="Link to this heading"></a></h2>
<p>You can also calculate the combined tidal potential from multiple celestial bodies:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># List of bodies</span>
<span class="n">bodylist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Moon&#39;</span><span class="p">,</span> <span class="s1">&#39;Sun&#39;</span><span class="p">,</span> <span class="s1">&#39;Mercury&#39;</span><span class="p">,</span> <span class="s1">&#39;Venus&#39;</span><span class="p">,</span> <span class="s1">&#39;Mars Barycenter&#39;</span><span class="p">,</span> <span class="s1">&#39;Jupiter Barycenter&#39;</span><span class="p">]</span>

<span class="c1"># Calculate combined TGP</span>
<span class="n">tgp_many</span> <span class="o">=</span> <span class="n">earth</span><span class="o">.</span><span class="n">tgp_many_bodies</span><span class="p">(</span><span class="n">bodylist</span><span class="p">,</span> <span class="n">loc_sta</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">dates</span><span class="o">=</span><span class="n">date</span><span class="p">,</span> <span class="n">nmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">body_signal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">time_array</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Plot the combined signal</span>
<span class="n">earth</span><span class="o">.</span><span class="n">plot_one_signal</span><span class="p">(</span><span class="n">et_utc</span><span class="p">,</span> <span class="n">tgp_many</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">mean_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">savepath</span><span class="o">=</span><span class="s1">&#39;./tgp-earth-planets.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference external image-reference" href="https://raw.githubusercontent.com/seap-udea/tspice/main/examples/gallery/tgp-earth-planets.png"><img alt="TGP Earth Planets" src="https://raw.githubusercontent.com/seap-udea/tspice/main/examples/gallery/tgp-earth-planets.png" />
</a>
</section>
<section id="calculating-planetary-response-love-numbers">
<h2>Calculating Planetary Response (Love Numbers)<a class="headerlink" href="#calculating-planetary-response-love-numbers" title="Link to this heading"></a></h2>
<p>tSPICE can also calculate the elastic response of a planetary body (Love numbers) by integrating interior models. Here is how to calculate the Love numbers $k_2, h_2, l_2$ for Earth using a modified PREM model:</p>
<p>First, initialize the package and define the responding body with its characteristic scales:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tspice</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tsp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tspice.planet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Earth</span>

<span class="c1"># Initialize</span>
<span class="n">tsp</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Define responding body and characteristic scales</span>
<span class="n">earth_interior</span> <span class="o">=</span> <span class="n">tsp</span><span class="o">.</span><span class="n">BodyResponse</span><span class="p">(</span><span class="s1">&#39;Earth&#39;</span><span class="p">)</span>
<span class="n">earth_interior</span><span class="o">.</span><span class="n">scale_constants</span><span class="p">()</span>
</pre></div>
</div>
<p>Next, load a planetary profile. In this case, we use the Modified PREM for Earth:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">earth_model</span> <span class="o">=</span> <span class="n">Earth</span><span class="p">()</span>
<span class="n">planet_profile</span> <span class="o">=</span> <span class="n">earth_model</span><span class="o">.</span><span class="n">planet_profile</span>
</pre></div>
</div>
<p>Define the internal layers of the planet (boundaries between fluid and solid regions matter):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The fluid outer core is sandwiched between the solid inner core and mantle</span>
<span class="n">layers_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Outer Core&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;fluid&#39;</span><span class="p">,</span> <span class="n">r0</span><span class="o">=</span><span class="mf">1221500.0</span><span class="p">,</span> <span class="n">rf</span><span class="o">=</span><span class="mf">3480000.0</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Inner Core&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="n">r0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rf</span><span class="o">=</span><span class="mf">1221500.0</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Mantle + crust&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="n">r0</span><span class="o">=</span><span class="mf">3480000.0</span><span class="p">,</span> <span class="n">rf</span><span class="o">=</span><span class="n">earth_interior</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Set the integration parameters for the desired tidal frequency (e.g., M2 tide) and spherical harmonic degree (n=2):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f_day</span> <span class="o">=</span> <span class="mf">1.93502</span>  <span class="c1"># cycles/day</span>
<span class="n">earth_interior</span><span class="o">.</span><span class="n">set_integration_parameters_ad</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">f_days</span><span class="o">=</span><span class="n">f_day</span><span class="p">,</span>
                                             <span class="n">layers_list</span><span class="o">=</span><span class="n">layers_list</span><span class="p">,</span>
                                             <span class="n">planet_profile</span><span class="o">=</span><span class="n">planet_profile</span><span class="p">,</span>
                                             <span class="n">r0_ini</span><span class="o">=</span><span class="mf">6e3</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, integrate the coupled ODEs and print the results:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Integrate</span>
<span class="n">earth_interior</span><span class="o">.</span><span class="n">integrate_internal_solutions_ad</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Access computed Love numbers</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;k_2 = </span><span class="si">{</span><span class="n">earth_interior</span><span class="o">.</span><span class="n">k_n</span><span class="si">}</span><span class="s2">, h_2 = </span><span class="si">{</span><span class="n">earth_interior</span><span class="o">.</span><span class="n">h_n</span><span class="si">}</span><span class="s2">, l_2 = </span><span class="si">{</span><span class="n">earth_interior</span><span class="o">.</span><span class="n">l_n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Output: k_2 = 0.2990433851603629, h_2 = 0.6093161139942496, l_2 = 0.08564339441970326</span>
</pre></div>
</div>
</section>
<section id="spectral-analysis-lomb-scargle">
<h2>Spectral Analysis (Lomb-Scargle)<a class="headerlink" href="#spectral-analysis-lomb-scargle" title="Link to this heading"></a></h2>
<p>You can also analyze the spectral content of the tidal signal to identify the main tidal modes (e.g., monthly, fortnightly). Here is how to compute the Lomb-Scargle periodogram for the Moon’s potential:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">astropy.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">LombScargle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">find_peaks</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Prepare time array in days</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">et_utc</span> <span class="o">-</span> <span class="n">et_utc</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3600</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>

<span class="c1"># Compute Periodogram (assuming tgp_one is the Moon&#39;s potential)</span>
<span class="n">frequency</span><span class="p">,</span> <span class="n">power</span> <span class="o">=</span> <span class="n">LombScargle</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">tgp_one</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">autopower</span><span class="p">(</span><span class="n">maximum_frequency</span><span class="o">=</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span><span class="o">**-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">amplitude</span> <span class="o">=</span> <span class="p">(</span><span class="n">power</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>

<span class="c1"># Find peaks</span>
<span class="n">peaks_ind</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span> <span class="n">prominence</span><span class="o">=</span><span class="mf">0.076</span><span class="p">)</span>
<span class="n">peaks_freq</span> <span class="o">=</span> <span class="n">frequency</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">peaks_ind</span><span class="p">]</span>
<span class="n">peaks_amp</span> <span class="o">=</span> <span class="n">amplitude</span><span class="p">[</span><span class="n">peaks_ind</span><span class="p">]</span>
<span class="n">peaks_period</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">peaks_freq</span>

<span class="c1"># Show main modes</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Frequency (1/d)&#39;</span><span class="p">:</span> <span class="n">peaks_freq</span><span class="p">,</span>
                   <span class="s1">&#39;Period (d)&#39;</span><span class="p">:</span> <span class="n">peaks_period</span><span class="p">,</span>
                   <span class="s1">&#39;Amplitude&#39;</span><span class="p">:</span> <span class="n">peaks_amp</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
<p>Visualizing the spectrum reveals the dominant periods (e.g., ~27 days for the Moon):</p>
<a class="reference external image-reference" href="https://raw.githubusercontent.com/seap-udea/tspice/main/examples/gallery/moon_tides.png"><img alt="Moon Tides Spectrum" src="https://raw.githubusercontent.com/seap-udea/tspice/main/examples/gallery/moon_tides.png" />
</a>
</section>
</section>
<section id="authors">
<h1>Authors<a class="headerlink" href="#authors" title="Link to this heading"></a></h1>
<ul class="simple">
<li><p><strong>Deivy Mercado</strong> - <a class="reference external" href="mailto:david231097&#37;&#52;&#48;gmail&#46;com">david231097<span>&#64;</span>gmail<span>&#46;</span>com</a></p></li>
<li><p><strong>Jorge I. Zuluaga</strong> - <a class="reference external" href="mailto:jorge&#46;zuluaga&#37;&#52;&#48;udea&#46;edu&#46;co">jorge<span>&#46;</span>zuluaga<span>&#64;</span>udea<span>&#46;</span>edu<span>&#46;</span>co</a></p></li>
<li><p><strong>Gloria Moncayo</strong> - <a class="reference external" href="mailto:gloria&#46;moncayo&#37;&#52;&#48;udea&#46;edu&#46;co">gloria<span>&#46;</span>moncayo<span>&#64;</span>udea<span>&#46;</span>edu<span>&#46;</span>co</a></p></li>
</ul>
</section>
<section id="license">
<h1>License<a class="headerlink" href="#license" title="Link to this heading"></a></h1>
<p>This project is licensed under the GNU Affero General Public License v3.0 (AGPL-3.0) - see the <a class="reference external" href="LICENSE">LICENSE</a> file for details.</p>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tides.html">Tides Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tides.html#classes">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="tides.html#tspice.tides.Body"><code class="docutils literal notranslate"><span class="pre">Body</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="tides.html#tspice.tides.BodyResponse"><code class="docutils literal notranslate"><span class="pre">BodyResponse</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="planet.html">Planet Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="planet.html#classes">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="planet.html#tspice.planet.Earth"><code class="docutils literal notranslate"><span class="pre">Earth</span></code></a></li>
</ul>
</li>
</ul>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="examples.html" class="btn btn-neutral float-right" title="Tutorials and Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Deivy Mercado, Jorge I. Zuluaga, Gloria Moncayo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>